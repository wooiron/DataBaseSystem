SELECT T.NAME, AVG(CP.LEVEL)
FROM TRAINER AS T, CATCHEDPOKEMON AS CP,
GYM AS G
WHERE T.ID = CP.OWNER_ID
AND T.ID = G.LEADER_ID
GROUP BY T.NAME
ORDER BY T.NAME;