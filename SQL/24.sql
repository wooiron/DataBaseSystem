SELECT C.NAME, AVG(CP.LEVEL)
FROM CITY AS C, TRAINER AS T,
CATCHEDPOKEMON AS CP
WHERE C.NAME = T.HOMETOWN
AND T.ID = CP.OWNER_ID
GROUP BY C.NAME
ORDER BY AVG(CP.LEVEL);